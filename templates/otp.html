<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='otp.css') }}">
</head>

<body>
    <div class="verify">
        <div class="description">
            <h3>Account Verification</h3>
            <span>Enter The One Time Password Shared Through Your Mail
                {{email}}
            </span>
        </div>
        <form action="/verification" method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div class="otp-container">
                <input type="text" maxlength="1" class="otp-input" name="d1" required/>
                <input type="text" maxlength="1" class="otp-input" name="d2" required/>
                <input type="text" maxlength="1" class="otp-input" name="d3" required/>
                <input type="text" maxlength="1" class="otp-input" name="d4" required/>
                <input type="text" maxlength="1" class="otp-input" name="d5" required/>
                <input type="text" maxlength="1" class="otp-input" name="d6" required/>
            </div>
            <div class="action">
                <a href='/signup/verification' style="text-decoration: none;">
                    <p>Resend OTP</p>
                </a>
                <button type="submit">Sign Up</button>
                <a href='/back'><button>Go Back</button></a>
            </div>
        </form>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        {% for message in messages%}
        <p class="message">{{message}}</p>
        {% endfor %}
        {% endif %}
        {% endwith %}
    </div>

    <script>
        const inputs = document.querySelectorAll(".otp-input");

        inputs.forEach((input, index) => {
            input.addEventListener("input", () => {
                if (input.value.length === 1 && index < inputs.length - 1) {
                    inputs[index + 1].focus();
                }
            });

            input.addEventListener("keydown", (e) => {
                if (e.key === "Backspace" && input.value === "" && index > 0) {
                    inputs[index - 1].focus();
                }
            });

            input.addEventListener("input", () => {
                input.value = input.value.replace(/[^0-9]/g, "");
            });
        });
    </script>

</body>
</html>